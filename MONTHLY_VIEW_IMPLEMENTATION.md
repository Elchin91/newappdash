# Реализация Monthly View

## Описание

Реализована полноценная функциональность для вкладки "Monthly" в Contact Center Dashboard с автоматическим выбором месяца и отображением двух таблиц с метриками звонков и чатов.

## Реализованные функции

### 1. Backend (Go)

#### Функция `GetMonthlyData` в `app.go`
- Получает месячные данные для указанного периода и очереди
- Возвращает данные в формате JSON с двумя разделами: `calls` и `chats`
- Использует SQL запросы из файла `mysql_mongodb.txt`
- Поддерживает форматирование времени в формате HH:MM:SS для AHT, FRT, RT

**Параметры:**
- `startDate` - начальная дата месяца (YYYY-MM-DD)
- `endDate` - конечная дата месяца (YYYY-MM-DD)  
- `queueName` - название очереди (all, m10, aml)

**Возвращаемые данные:**
```json
{
  "calls": [
    {
      "day": 1,
      "total_calls": 150,
      "avg_call_duration": "00:02:30",
      "sl": 85.5,
      "total_abandoned": 10,
      "distinct_agents": 8
    }
  ],
  "chats": [
    {
      "day": 1,
      "total_chats": 45,
      "avg_chat_frt": "00:01:15",
      "resolution_time_avg": "00:05:45"
    }
  ]
}
```

### 2. Frontend (React + TypeScript)

#### Компонент `MonthlyView.tsx`
- Новый React компонент для отображения месячных данных
- Автоматическая генерация выпадающего списка месяцев (текущий + 23 предыдущих)
- Две отдельные таблицы для данных звонков и чатов
- Отображение всех дней месяца с данными или нулевыми значениями
- Форматирование времени в HH:MM:SS для AHT, FRT, RT

**Особенности:**
- Автоматическое определение количества дней в выбранном месяце
- Русская локализация названий месяцев
- Цветовое кодирование метрик
- Адаптивный дизайн с горизонтальной прокруткой для больших таблиц

#### Обновленный `Sidebar.tsx`
- Автоматическая генерация списка доступных месяцев
- Передача выбранного месяца в основное приложение
- Скрытие селектора метрик для Monthly view

#### Обновленный `Dashboard.tsx`
- Интеграция нового компонента MonthlyView
- Передача параметров между компонентами

#### Обновленный `App.tsx`
- Добавлено состояние для выбранного месяца
- Передача props между всеми компонентами

### 3. Таблицы данных

#### Таблица звонков
| Метрика | 1 | 2 | 3 | ... | 31 |
|---------|---|---|---|-----|----| 
| Звонки | 532 | 507 | 338 | ... | 333 |
| AHT | 02:15:00 | 02:30:00 | 02:45:00 | ... | 02:20:00 |
| SL (%) | 92.0% | 89.0% | 87.0% | ... | 91.0% |
| Заброшенные | 6 | 8 | 17 | ... | 4 |
| Агенты | 38 | 42 | 29 | ... | 27 |

#### Таблица чатов
| Метрика | 1 | 2 | 3 | ... | 31 |
|---------|---|---|---|-----|----| 
| Чаты | 1421 | 1605 | 1447 | ... | 937 |
| FRT | 00:03:00 | 00:01:00 | 00:01:00 | ... | 00:01:00 |
| RT | 00:08:00 | 00:03:00 | 00:01:00 | ... | 00:06:00 |

## Использованные SQL запросы

### Запросы для звонков
- Общее количество звонков по дням
- Среднее время обработки (AHT) в формате HH:MM:SS
- Уровень сервиса (SL) в процентах
- Количество заброшенных звонков
- Количество уникальных агентов

### Запросы для чатов  
- Общее количество чатов по дням
- Время первого ответа (FRT) в формате HH:MM:SS
- Время решения (RT) в формате HH:MM:SS

## Технические особенности

1. **Автоматическая генерация месяцев**: Список месяцев создается динамически начиная с текущего месяца
2. **Форматирование времени**: Все временные метрики отображаются в формате HH:MM:SS согласно требованиям
3. **Обработка пустых данных**: Дни без данных отображаются с нулевыми значениями
4. **Адаптивный дизайн**: Таблицы адаптируются под разные размеры экрана
5. **Цветовое кодирование**: Разные метрики имеют разные цвета для лучшего восприятия

## Файлы, которые были изменены/созданы

### Созданы:
- `db-management-app/frontend/src/components/MonthlyView.tsx`

### Изменены:
- `db-management-app/app.go` - добавлена функция GetMonthlyData
- `db-management-app/frontend/src/components/Dashboard.tsx` - интеграция MonthlyView
- `db-management-app/frontend/src/components/Sidebar.tsx` - обновлен селектор месяцев
- `db-management-app/frontend/src/App.tsx` - добавлено состояние selectedMonth

### Автоматически обновлены:
- `db-management-app/frontend/wailsjs/go/main/App.js` - добавлен binding для GetMonthlyData
- `db-management-app/frontend/wailsjs/go/main/App.d.ts` - добавлены TypeScript определения

## Как использовать

1. Запустите приложение: `wails dev`
2. Перейдите на вкладку "Monthly" в сайдбаре
3. Выберите нужный месяц из выпадающего списка
4. Просмотрите данные в двух таблицах: звонки и чаты
5. Все временные метрики отображаются в формате HH:MM:SS как требовалось

## Соответствие требованиям

✅ **Выбор месяца из выпадающего списка** - Реализован с автоматическим добавлением новых месяцев  
✅ **Две таблицы** - Отдельные таблицы для звонков и чатов как на скриншоте  
✅ **Формат времени HH:MM:SS** - AHT, FRT и RT отображаются в требуемом формате  
✅ **Использование SQL запросов** - Все запросы взяты из предоставленного файла mysql_mongodb.txt 