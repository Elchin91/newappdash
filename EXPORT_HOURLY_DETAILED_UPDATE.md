# Обновление: Экспорт в Excel для метрики "Detailed Daily"

## Описание изменений

Добавлена возможность экспорта в Excel для метрики "Detailed daily" (почасовые данные) в приложении управления базой данных.

## Новые функции

### 1. Функция экспорта почасовых данных

**Файл:** `db-management-app/frontend/src/utils/excelExport.ts`

- Добавлен интерфейс `HourlyDetailedData` для описания структуры почасовых данных
- Реализована функция `exportHourlyDetailedToExcel()` для экспорта данных в Excel
- Создается отдельный лист для каждого дня
- Добавляется сводный лист со всеми данными (при наличии нескольких дней)

### 2. Интеграция в DailyView

**Файл:** `db-management-app/frontend/src/components/DailyView.tsx`

- Добавлен импорт функции `exportHourlyDetailedToExcel`
- Реализованы специальные кнопки экспорта для метрики "detailed_daily"
- Кнопка экспорта активна только при наличии данных

### 3. Активация экспорта в HourlyView

**Файл:** `db-management-app/frontend/src/components/HourlyView.tsx`

- Добавлен импорт функции экспорта
- Реализована функция генерации тестовых данных для экспорта
- Активирована кнопка экспорта с возможностью экспорта в Excel

## Особенности экспорта

### Структура Excel файла:

**Единый лист "Hourly Data" со всеми данными:**
- Таблицы для каждого дня идут одна за другой
- Формат: Дата/Метрика | 00:00 | 01:00 | ... | 23:00
- Заголовок с датой, затем строки с метриками
- Пустая строка между днями для разделения

3. **Стилизация:**
   - Заголовки выделены серым цветом и жирным шрифтом
   - Данные центрированы
   - Границы для всех ячеек
   - Автоматическая ширина колонок

### Поддерживаемые метрики:

- **Calls** - количество звонков
- **AHT (min)** - среднее время обработки (в минутах)
- **SL (%)** - уровень сервиса (в процентах)
- **Abandoned** - количество сброшенных звонков
- **Chats** - количество чатов
- **FRT (min)** - время первого ответа (в минутах)
- **RT (min)** - время решения (в минутах)
- **Agents** - количество агентов
- **Total** - общее количество

## Использование

### В Daily View:
1. Выберите метрику "Detailed daily"
2. Нажмите кнопку "Export Hourly"
3. Файл автоматически скачается

### В Hourly View:
1. Нажмите кнопку "Export Hourly" 
2. Экспортируются тестовые данные для всех метрик

## Имена файлов

Формат: `Hourly_Detailed_[QueueName]_[StartDate]_to_[EndDate].xlsx`

Пример: `Hourly_Detailed_SALES_2025-01-01_to_2025-01-03.xlsx`

## Типизация

```typescript
interface HourlyDetailedData {
  date: string;
  metric: string;
  hour_0: number | string;
  hour_1: number | string;
  // ... hour_2 to hour_23
}
```

## Готовность к интеграции

Код готов для интеграции с реальными данными:
- Замените функции генерации тестовых данных на вызовы API
- Данные должны соответствовать интерфейсу `HourlyDetailedData`
- Обновите состояние `hourlyDetailedData` в компонентах

## Файлы изменений

- ✅ `db-management-app/frontend/src/utils/excelExport.ts` - новая функция экспорта
- ✅ `db-management-app/frontend/src/components/DailyView.tsx` - интеграция экспорта
- ✅ `db-management-app/frontend/src/components/HourlyView.tsx` - активация кнопки экспорта

---

**Дата обновления:** 21 января 2025  
**Статус:** Реализовано и готово к использованию 